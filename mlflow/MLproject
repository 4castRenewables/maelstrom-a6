name: a6

docker_env:
  image: a6-mlflow:latest
  volumes: ["${PWD}/../data:/data"]
  environment: ["MLFLOW_TRACKING_TOKEN"]

entry_points:
  kmeans:
    parameters:
      weather_data:
        type: string
      level:
        type: int
        default: None
      n_components_start:
        type: int
      n_components_end:
        type: int
        default: None
      n_clusters_start:
        type: int
      n_clusters_end:
        type: int
        default: None
      use_varimax:
        type: bool
        default: False
      log_to_mantik:
        type: bool
        default: True
    command: >
      a6 \
        --log-to-mantik {log_to_mantik} \
        train kmeans \
        --weather-data {weather_data} \
        --level {level} \
        --n-components-start {n_components_start} \
        --n-components-end {n_components_end} \
        --n-clusters-start {n_clusters_start} \
        --n-clusters-end {n_clusters_end} \
        --use-varimax {use_varimax}
  hdbscan:
    parameters:
      weather_data:
        type: string
      vary_data_variables:
        type: bool
        default: False
      level:
        type: int
        default: None
      n_components_start:
        type: int
        default: 3
      n_components_end:
        type: int
        default: None
      min_cluster_size_start:
        type: int
        default: 2
      min_cluster_size_end:
        type: int
        default: None
      use_varimax:
        type: bool
        default: False
      log_to_mantik:
        type: bool
        default: False
    command: >
      a6 \
        --log-to-mantik {log_to_mantik} \
        train hdbscan \
        --weather-data {weather_data} \
        --vary-data-variables {vary_data_variables} \
        --level {level} \
        --n-components-start {n_components_start} \
        --n-components-end {n_components_end} \
        --min-cluster-size-start {min_cluster_size_start} \
        --min-cluster-size-end {min_cluster_size_end} \
        --use-varimax {use_varimax}
  temporal:
    parameters:
      weather_data:
        type: string
      level:
        type: int
        default: None
      n_components:
        type: int
        default: 3
      min_cluster_size:
        type: int
        default: 2
      use_varimax:
        type: bool
        default: False
      log_to_mantik:
        type: bool
        default: False
    command: >
      a6 \
        --log-to-mantik {log_to_mantik} \
        train temporal-study \
        --weather-data {weather_data} \
        --level {level} \
        --n-components {n_components} \
        --min-cluster-size {min_cluster_size} \
        --use-varimax {use_varimax}
  grid_search:
    parameters:
      weather_data:
        type: string
      level:
        type: int
        default: None
      turbine_data:
        type: str
      log_to_mantik:
        type: bool
        default: False
    command: >
      a6 \
        --log-to-mantik {log_to_mantik} \
        grid-search \
        --weather-data {weather_data} \
        --level {level} \
        --turbine-data {turbine_data}

